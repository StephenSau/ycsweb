define(["jquery"],function(e){"use strict";function t(t,r,s){var i=this;this.func=void 0,this.needTips=s||!1,this.form=t,this.loadingBox=null,this.checkArea=this.findCheckArea(),void 0!==r&&"function"==typeof r&&(this.func=r),this.checkRange=function(e,t,r,s){return this.checkDirty(e,s)?this.messageInfo.dirty:e&&(e.length<t||e.length>r)?"请输入"+t+"至"+r+"个字符":""},this.checkAccount=function(e,t){return this.checkDirty(e,t)?this.messageInfo.dirty:e?/^[A-Za-z0-9\-\_]{4,20}$/.test(e)?"":"请输入4-20位字母、数字或“-”、“_”字符":""},this.checkLength=function(e,t,r){return this.checkDirty(e,r)?this.messageInfo.dirty:e&&e.length!==1*t?void 0!==r&&"true"!==r?r:this.messageInfo.lengthError+t+"个字符":""},this.checkCNName=function(e,t){return this.checkDirty(e,t)?this.messageInfo.dirty:e?/^[\u4E00-\u9FBF]{2,8}$/.test(e)?"":this.messageInfo.nameError:""},this.checkName=function(e,t,r,s){if(this.checkDirty(e,s))return this.messageInfo.dirty;if(!e)return"";var i=new RegExp("^[\\u4E00-\\u9FBFA-Za-z]{"+t+","+r+"}$");return/^\s+$/.test(e)||!i.test(e)?"请输入"+t+"-"+r+"位中英文字符":""},this.checkTelphone=function(e,t){return this.checkDirty(e,t)?this.messageInfo.dirty:e?/^1(3[0-9]|4[0-9]|5[0-35-9]|7[0-9]|8[0-9])\d{8}$/.test(e)?"":this.messageInfo.phoneError:""},this.checkPhone=function(e,t){return this.checkDirty(e,t)?this.messageInfo.dirty:e?/^(\d{0,4}-)?\d{8}$/.test(e)?"":"请输入正确的座机号(如020-38383838)":""},this.checkCode=function(e,t){return this.checkDirty(e,t)?this.messageInfo.dirty:e?/^\d{6}$/.test(e)?"":this.messageInfo.codeError:""},this.checkId=function(e,t){if(this.checkDirty(e,t))return this.messageInfo.dirty;if(!e)return"";if(!/^(\d{6})(18|19|20)?(\d{2})([01]\d)([0123]\d)(\d{3})(\d|X)?$/.test(e))return this.messageInfo.idError;var r=e.length;if(18===r){for(var s=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],i=["1","0","X","9","8","7","6","5","4","3","2"],n=0,a=0;17>a;a++)n+=parseInt(e.substr(a,1),10)*s[a];if(e.substr(17,1)!==i[n%11])return this.messageInfo.idError}return""},this.checkMoney=function(e,t){if(this.checkDirty(e,t))return this.messageInfo.dirty;if(!e)return"";var r=/(^[1-9]\d*(\.\d{1,2})?$)|(^0\.\d{1,2}$)/;return r.test(e)?"":this.messageInfo.moneyError},this.checkNumber=function(e,t,r){if(this.checkDirty(e,r))return this.messageInfo.dirty;if(!e)return"";var s=new RegExp("^\\d{"+t+"}$");return s.test(e)?"":this.messageInfo.numberError},this.checkWords=function(e,t,r,s){if(this.checkDirty(e,s))return this.messageInfo.dirty;if(!e)return"";var i=new RegExp("^[\\u4E00-\\u9FBFA-Za-z0-9 ]{"+t+","+r+"}$");return/^\s+$/.test(e)||!i.test(e)?"请输入"+t+"-"+r+"位中英文数字字符":""},this.checkDate=function(e,t,r){if(this.checkDirty(e,r))return this.messageInfo.dirty;if(!e)return"";var s=/^[12]\d{3}-(1[0-2]|0[1-9])-([0][1-9]|[12]\d|3[0-1])$/;if(t&&"true"!==t){var i=t.replace(/(yy|yyyy|MM|dd|hh|mm|ss)/,function(e,t,r){switch(e){case"yy":return"d{2}";case"yyyy":return"[12]d{3}";case"MM":return"(1[0-2]|0d)";case"dd":return"(3[0-1]|[0-2]d)";case"hh":return"(2[0-4]|[0-1]d)";case"mm":return"[0-5]d";case"ss":return"[0-5]d"}});s=new RegExp("^"+i+"$")}return s.test(e)?"":this.messageInfo.dateError},this.checkEmail=function(e,t){return this.checkDirty(e,t)?this.messageInfo.dirty:e?/^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/.test(e)?"":this.messageInfo.emailError:""},this.checkEmpty=function(e,t){return""===e?t?t:this.messageInfo.emptyError:""},this.checkLicensePlateNo=function(e,t){var r={7:/^[\u4E00-\u9FBF][A-Za-z][A-Za-z0-9]{4}[A-Za-z0-9港澳挂]$/,6:/^[A-Za-z][A-Za-z0-9]{4}[A-Za-z0-9港澳挂]$/,5:/^[A-Za-z0-9]{4}[A-Za-z0-9港澳挂]$/},s=r[t],i="5"===t?2:3,n=!1;return s.test(e)?(!e.match(/[A-Za-z]/g)||e.match(/[A-Za-z]/g).length<=i)&&(n=!0):n=!1,n?"":this.messageInfo.licensePlateNoError},this.checkConfirm=function(e,t,r){var s=0,i=[];if(this.checkDirty(e,r))return this.messageInfo.dirty;if(!e)return"";for(s=0;s<this.checkArea.length;s++)"password"===this.checkArea[s].type&&i.push(this.checkArea[s].value);return 2===i.length?""===i[1]?this.messageInfo.passwordError:i[1]===i[0]?"":this.messageInfo.passwordError:t?""===e?this.messageInfo.passwordError:e===document.getElementById(t).value?"":this.messageInfo.passwordError:void 0},this.submitForm=function(e){this.checkValidity()?void 0!==this.func&&(e.preventDefault(),this.func("this.loadingBox")):e.preventDefault()},e(this.form).submit(function(e){i.submitForm(e)})}return t.prototype={messageInfo:{dirty:"此为必填项",licensePlateNoError:"请输入正确的车牌号码",lengthError:"输入信息不满",moneyError:"请输入价钱",numberError:"请输入数值",emptyError:"请填写或选择",nameError:"请填写2~8个中文名",phoneError:"请填写正确的手机号码",idError:"请填写正确的身份证",codeError:"请填写正确邮寄编码",dateError:"请输入正确的日期",emailError:"请填写正确的电子邮箱",passwordError:"密码不一致请重新输入"},checkDirty:function(e,t){var r="true"===t?!1:!0;return r?r&&""===e?!0:void 0:!1},findCheckArea:function(){for(var e=this.form.elements,t=[],r=0,s=e.length;s>r;r++)e[r].getAttribute("data-rule")&&t.push(e[r]);return t},checkValidity:function(){var t=0,r=this,s=this.checkArea.length,i=null,n="",a="",h=function(){r.addWatch(this)},c=!0;for(t=0;s>t;t++){i=this.checkArea[t],n="";i.getAttribute("data-rule")&&(a=this.getResult(i),"SELECT"===i.tagName.toUpperCase()||"INPUT"===i.tagName.toUpperCase()&&("checkbox"===i.type||"radio"===i.type)?e(i).unbind("change",h).bind("change",h):"INPUT"!==i.tagName.toUpperCase()&&"TEXTAREA"!==i.tagName.toUpperCase()||"checkbox"===i.type||"radio"===i.type||e(i).unbind("keyup",h).bind("keyup",h),""!==a?(this.changeStatus(i,"invalid",a),c=!1):this.changeStatus(i,"valid"))}return c},changeStatus:function(t,r,s){var i="",n=null;"checkbox"!==t.type&&"radio"!==t.type?(e(t).removeClass("valid invalid").addClass(r),"SELECT"!==t.tagName.toUpperCase()&&this.needTips&&(i=t.getAttribute("data-error-target"),n=null,i||(i="e"+parseInt(1e16*Math.random(),10),t.setAttribute("data-error-target",i)),document.getElementById(i)?n=e("#"+i):(n=e('<span class="error" id="'+i+'" style="display:none;"></span>'),e(t).parent().append(n)),"invalid"===r&&s?n.html(s).show():"valid"===r&&n.hide())):e(t).parent(".form-choice-group").removeClass("valid invalid").addClass(r),"SELECT"===t.tagName.toUpperCase()&&e(t).trigger("chosen:change")},getResult:function(t){var r=0,s=0,i=[],n=[],a=null,h=null,c="",o="";if(i=t.getAttribute("data-rule").split(":"),"checkbox"===t.type)if(name=t.getAttribute("name"),h=e("input:checkbox[name="+name+"]:checked"),h.length)for(r=0,s=h.length;s>r;r++)c=c+h[r].value+(r===s-1?"":",");else c="";else"radio"===t.type?(name=t.getAttribute("name"),a=e("input:radio[name="+name+"]:checked"),c=a.length?a.val():""):c=t.value;return n=i[1]?n.concat(c,i[1].split(",")):[c],o=this[i[0]].apply(this,n)},addWatch:function(e){var t="";e.getAttribute("data-rule")&&(t=this.getResult(e),""!==t?this.changeStatus(e,"invalid",t):this.changeStatus(e,"valid"))}},t});